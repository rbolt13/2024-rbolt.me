fill = Occupation)
) +
# Geom (with outline)
geom_bar(
width = 1,
stat = "identity",
color = "black",
size = 0.2
) +
# Pie Chart
coord_polar(
"y",
start = 15,
direction = 1
) +
# Legend Colors and Order
scale_fill_manual(
values = colors,
breaks = c(
"Teachers", "Ministers", "Government Service",
"Business", "Other Professions", "House Wives"
)
) +
# Remove grid from pie chart
theme_void() +
# Labels
labs(
title = title_text,
subtitle = subtitle_text,
caption = caption_text
) +
# Values on Pie Graph
# ggrepel::geom_text_repel(
#   aes = (label = paste0(Percentage, "%")),
#   size = 3,
#   vjust = 0.5,
# ) +
# Theme
theme(
# Title
plot.title = element_markdown(
size = 11,
hjust = 0,
lineheight = 0.9,
family = "font",
face = "bold",
color = col1),
plot.title.position = "plot",
# Subtitle
plot.subtitle = element_markdown(
size = 8,
hjust = 0.5,
lineheight = 0.9,
family = "font",
color = col1
),
# Caption
plot.caption = element_text(
size = 6,
family = "font",
color = col1,
hjust = 1
),
# Legend
legend.position = "left",
legend.title = element_blank(),
legend.text = element_text(
size = 8,
family = "font",
color = col1),
legend.key = element_blank(),
legend.background = element_blank(),
# Background
plot.background = element_rect(fill = col2, color = NA),
# Plot Margins
plot.margin = margin(t = 20, r = 20, b = 20, l = 20))
# Display the pie chart
print(pie)
# ggrepel::geom_text_repel(
#   aes = (label = paste0(Percentage, "%")),
#   size = 3,
#   vjust = 0.5,
# ) +
pie <- ggplot(
# Data
dubois,
# Aesthetics
aes(
x = factor(1),
y = Percentage,
fill = Occupation)
) +
# Geom (with outline)
geom_bar(
width = 1,
stat = "identity",
color = "black",
size = 0.2
) +
# Pie Chart
coord_polar(
"y",
start = 15,
direction = 1
) +
# Legend Colors and Order
scale_fill_manual(
values = colors,
breaks = c(
"Teachers", "Ministers", "Government Service",
"Business", "Other Professions", "House Wives"
)
) +
# Remove grid from pie chart
theme_void() +
# Labels
labs(
title = title_text,
subtitle = subtitle_text,
caption = caption_text
) +
# Values on Pie Graph
# ggrepel::geom_text_repel(
#   aes = (label = paste0(Percentage, "%")),
#   size = 3,
#   vjust = 0.5,
# ) +
# Theme
theme(
# Title
plot.title = element_markdown(
size = 11,
hjust = 0,
lineheight = 0.9,
family = "font",
face = "bold",
color = col1),
plot.title.position = "plot",
# Subtitle
plot.subtitle = element_markdown(
size = 8,
hjust = 0.5,
lineheight = 0.9,
family = "font",
color = col1
),
# Caption
plot.caption = element_text(
size = 6,
family = "font",
color = col1,
hjust = 1
),
# Legend
legend.position = "left",
legend.title = element_blank(),
legend.text = element_text(
size = 8,
family = "font",
color = col1),
legend.key = element_blank(),
legend.background = element_blank(),
# Background
plot.background = element_rect(fill = col2, color = NA),
# Plot Margins
plot.margin = margin(t = 20, r = 20, b = 20, l = 20))
# Display the pie chart
print(pie)
pie <- ggplot(
# Data
dubois,
# Aesthetics
aes(
x = factor(1),
y = Percentage,
fill = Occupation)
) +
# Geom (with outline)
geom_bar(
width = 1,
stat = "identity",
color = "black",
size = 0.2
) +
# Pie Chart
coord_polar(
"y",
start = 15,
direction = 1
) +
# Legend Colors and Order
scale_fill_manual(
values = colors,
breaks = c(
"Teachers", "Ministers", "Government Service",
"Business", "Other Professions", "House Wives"
)
) +
# Remove grid from pie chart
theme_void() +
# Labels
labs(
title = title_text,
subtitle = subtitle_text,
caption = caption_text
) +
# Values on Pie Graph
ggrepel::geom_text_repel(
aes = (label = paste0(Percentage, "%")),
size = 3,
vjust = 0.5,
) +
# Theme
theme(
# Title
plot.title = element_markdown(
size = 11,
hjust = 0,
lineheight = 0.9,
family = "font",
face = "bold",
color = col1),
plot.title.position = "plot",
# Subtitle
plot.subtitle = element_markdown(
size = 8,
hjust = 0.5,
lineheight = 0.9,
family = "font",
color = col1
),
# Caption
plot.caption = element_text(
size = 6,
family = "font",
color = col1,
hjust = 1
),
# Legend
legend.position = "left",
legend.title = element_blank(),
legend.text = element_text(
size = 8,
family = "font",
color = col1),
legend.key = element_blank(),
legend.background = element_blank(),
# Background
plot.background = element_rect(fill = col2, color = NA),
# Plot Margins
plot.margin = margin(t = 20, r = 20, b = 20, l = 20))
pie <- ggplot(
# Data
dubois,
# Aesthetics
aes(
x = factor(1),
y = Percentage,
fill = Occupation)
) +
# Geom (with outline)
geom_bar(
width = 1,
stat = "identity",
color = "black",
size = 0.2
) +
# Pie Chart
coord_polar(
"y",
start = 15,
direction = 1
) +
# Legend Colors and Order
scale_fill_manual(
values = colors,
breaks = c(
"Teachers", "Ministers", "Government Service",
"Business", "Other Professions", "House Wives"
)
) +
# Remove grid from pie chart
theme_void() +
# Labels
labs(
title = title_text,
subtitle = subtitle_text,
caption = caption_text
) +
# Values on Pie Graph
ggrepel::geom_text_repel(
aes = (label = paste0(Percentage, "%")),
# size = 3,
# vjust = 0.5,
) +
# Theme
theme(
# Title
plot.title = element_markdown(
size = 11,
hjust = 0,
lineheight = 0.9,
family = "font",
face = "bold",
color = col1),
plot.title.position = "plot",
# Subtitle
plot.subtitle = element_markdown(
size = 8,
hjust = 0.5,
lineheight = 0.9,
family = "font",
color = col1
),
# Caption
plot.caption = element_text(
size = 6,
family = "font",
color = col1,
hjust = 1
),
# Legend
legend.position = "left",
legend.title = element_blank(),
legend.text = element_text(
size = 8,
family = "font",
color = col1),
legend.key = element_blank(),
legend.background = element_blank(),
# Background
plot.background = element_rect(fill = col2, color = NA),
# Plot Margins
plot.margin = margin(t = 20, r = 20, b = 20, l = 20))
# ggrepel::geom_text_repel(
#   aes = (label = paste0(Percentage, "%")),
#   size = 3,
#   vjust = 0.5,
# ) +
pie <- ggplot(
# Data
dubois,
# Aesthetics
aes(
x = factor(1),
y = Percentage,
fill = Occupation)
) +
# Geom (with outline)
geom_bar(
width = 1,
stat = "identity",
color = "black",
size = 0.2
) +
# Pie Chart
coord_polar(
"y",
start = 15,
direction = 1
) +
# Legend Colors and Order
scale_fill_manual(
values = colors,
breaks = c(
"Teachers", "Ministers", "Government Service",
"Business", "Other Professions", "House Wives"
)
) +
# Remove grid from pie chart
theme_void() +
# Labels
labs(
title = title_text,
subtitle = subtitle_text,
caption = caption_text
) +
# Values on Pie Graph
# ggrepel::geom_text_repel(
#   aes = (label = paste0(Percentage, "%")),
#   size = 3,
#   vjust = 0.5,
# ) +
# Theme
theme(
# Title
plot.title = element_markdown(
size = 11,
hjust = 0,
lineheight = 0.9,
family = "font",
face = "bold",
color = col1),
plot.title.position = "plot",
# Subtitle
plot.subtitle = element_markdown(
size = 8,
hjust = 0.5,
lineheight = 0.9,
family = "font",
color = col1
),
# Caption
plot.caption = element_text(
size = 6,
family = "font",
color = col1,
hjust = 1
),
# Legend
legend.position = "left",
legend.title = element_blank(),
legend.text = element_text(
size = 8,
family = "font",
color = col1),
legend.key = element_blank(),
legend.background = element_blank(),
# Background
plot.background = element_rect(fill = col2, color = NA),
# Plot Margins
plot.margin = margin(t = 20, r = 20, b = 20, l = 20))
# Display the pie chart
print(pie)
#| code-fold: true
#| code-summary: "Show Code"
#| warning: false
ggsave(
"plot.png",
width = 5,
height = 6,
units = "in",
dpi = 85)
library(ggplot2)
library(ggrepel)
library(tidyverse)
df2 <- df %>%
mutate(csum = rev(cumsum(rev(value))),
pos = value/2 + lead(csum, 1),
pos = if_else(is.na(pos), value/2, pos))
df2 <- df %>%
mutate(csum = rev(cumsum(rev(value))),
pos = value/2 + lead(csum, 1),
pos = if_else(is.na(pos), value/2, pos))
df <- data.frame(value = c(15, 25, 32, 28),
group = paste0("G", 1:4))
library(dplyr)
df2 <- df %>%
mutate(csum = rev(cumsum(rev(value))),
pos = value/2 + lead(csum, 1),
pos = if_else(is.na(pos), value/2, pos))
ggplot(df, aes(x = "" , y = value, fill = fct_inorder(group))) +
geom_col(width = 1, color = 1) +
coord_polar(theta = "y") +
scale_fill_brewer(palette = "Pastel1") +
geom_label_repel(data = df2,
aes(y = pos, label = paste0(value, "%")),
size = 4.5, nudge_x = 1, show.legend = FALSE) +
guides(fill = guide_legend(title = "Group")) +
theme_void()
dubois
dubois2 <- dubois |>
mutate(csum = rev(cumsum(rev(Percentage))),
pos = Percerntage/2 +lead(csum, 1),
pos = if_else(is.na(pos), Percentage/2, Percentage))
dubois
dubois2 <- dubois |>
mutate(csum = rev(cumsum(rev(Percentage))),
pos = Percerntage/2 +lead(csum, 1),
pos = if_else(is.na(pos), Percentage/2, Percentage))
dubois
df <- data.frame(value = c(15, 25, 32, 28),
group = paste0("G", 1:4))
dubois <- data.frame(
Occupation = dubois$Occupation,
Percentage = dubois$Percentage,
Label = dubois$label
)
dubois2 <- dubois |>
mutate(csum = rev(cumsum(rev(Percentage))),
pos = Percerntage/2 +lead(csum, 1),
pos = if_else(is.na(pos), Percentage/2, Percentage))
dubois
dubois
dubois2 <- dubois |>
mutate(csum = rev(cumsum(rev(Percentage))),
pos = Percerntage/2 +lead(csum, 1),
pos = if_else(is.na(pos), Percentage/2, Percentage))
dubois
df <- data.frame(value = c(15, 25, 32, 28),
group = paste0("G", 1:4))
df <- data.frame(value = dubois$Percentage,
group = dubois$Occupation)
dubois <- data.frame(
Occupation = dubois$Occupation,
Percentage = dubois$Percentage,
Label = dubois$label
)
dubois
df2 <- df %>%
mutate(csum = rev(cumsum(rev(value))),
pos = value/2 + lead(csum, 1),
pos = if_else(is.na(pos), value/2, pos))
ggplot(df, aes(x = "" , y = value, fill = fct_inorder(group))) +
geom_col(width = 1, color = 1) +
coord_polar(theta = "y") +
scale_fill_brewer(palette = "Pastel1") +
geom_label_repel(data = df2,
aes(y = pos, label = paste0(value, "%")),
size = 4.5, nudge_x = 1, show.legend = FALSE) +
guides(fill = guide_legend(title = "Group")) +
theme_void()
